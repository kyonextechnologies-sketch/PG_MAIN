(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4636],{37999:(e,s,t)=>{Promise.resolve().then(t.bind(t,73013))},73013:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(95155),l=t(12115),r=t(5634),n=t(11829),i=t(86948),d=t(3998),c=t(75273),o=t(245),x=t(6191),m=t(91169),h=t(20508),u=t(65993),b=t(11010),p=t(57828),f=t(69141),g=t(71360),j=t(46713),N=t(68796),y=t(52205),w=t(57776),v=t(36489),C=t(20063);function k(){let{data:e,status:s}=(0,v.useSession)(),t=(0,C.useRouter)(),[k,A]=(0,l.useState)(!1),[T,R]=(0,l.useState)(null),[E,P]=(0,l.useState)(!1),[S,F]=(0,l.useState)(null),{tenants:Z,loading:D,error:_,createTenant:W,updateTenant:B,deleteTenant:O,fetchTenants:V}=(0,j.x)(),{addNotification:$}=(0,N.j)(),{properties:I,loading:U,error:z,fetchProperties:M}=(0,y.B)(),{rooms:L,loading:q,error:G,fetchRooms:H}=(0,w.o)(),J=l.useRef(new Set),K=l.useCallback(async()=>{for(let e of I)J.current.has(e.id)||(J.current.add(e.id),await H(e.id))},[I,H]);l.useEffect(()=>{I.length>0&&K()},[K]);let Q=l.useMemo(()=>I.map(e=>({...e,rooms:L.filter(s=>s.propertyId===e.id).map(e=>({id:e.id,name:"Room ".concat(e.roomNumber),roomNumber:e.roomNumber,capacity:e.capacity,occupied:e.occupied||0,beds:e.beds&&e.beds.length>0?e.beds:[]}))})),[I,L]);if(l.useEffect(()=>{var a;if("loading"!==s){if("unauthenticated"===s)return void t.push("/login");null==e||null==(a=e.user)||a.id}},[s,e,t]),"loading"===s)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading..."})]})});if("unauthenticated"===s)return null;let X=async e=>{try{T?await B(T.id,e)?$({type:"success",title:"Tenant Updated",message:"".concat(e.name," has been updated successfully."),read:!1}):$({type:"error",title:"Update Failed",message:"Failed to update tenant. Please try again.",read:!1}):await W(e)?$({type:"success",title:"Tenant Added",message:"".concat(e.name," has been added successfully with login credentials."),read:!1}):$({type:"error",title:"Creation Failed",message:"Failed to create tenant. Please try again.",read:!1}),A(!1),R(null)}catch(e){$({type:"error",title:"Error",message:e.message||"An error occurred",read:!1})}},Y=async e=>{let s=Z.find(s=>s.id===e);if(s)try{await O(e)?$({type:"success",title:"Tenant Deleted",message:"".concat(s.name," has been deleted."),read:!1}):$({type:"error",title:"Delete Failed",message:"Failed to delete tenant. Please try again.",read:!1})}catch(e){$({type:"error",title:"Error",message:e.message||"Failed to delete tenant",read:!1})}},ee=e=>{$({type:"info",title:"View Tenant",message:"Viewing details for ".concat(e.name,"..."),read:!1})},es=[{key:"name",label:"Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"phone",label:"Phone",sortable:!0},{key:"propertyId",label:"Property & Room",sortable:!0,render:e=>Z.find(s=>s.propertyId===e)?(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900"}),(0,a.jsx)("div",{className:"text-gray-600",children:"Room "})]}):"N/A"},{key:"status",label:"Status",sortable:!0,render:e=>(0,a.jsx)(o.W,{status:e})}];return(0,a.jsx)(n.m8,{role:"OWNER",children:(0,a.jsx)(r.O,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Tenants"}),(0,a.jsx)("p",{className:"text-gray-700 font-semibold",children:"Manage tenant information and allocations"})]}),(0,a.jsxs)(d.$,{onClick:()=>{R(null),A(!0)},className:"bg-green-600 hover:bg-green-700 text-white font-semibold shadow-lg",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Add Tenant"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(i.Zp,{className:"bg-gradient-to-br from-green-50 to-green-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-bold text-green-800",children:"Total Tenants"}),(0,a.jsx)("div",{className:"p-2 bg-green-500 rounded-lg",children:(0,a.jsx)(m.A,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-green-900",children:Z.length}),(0,a.jsx)("p",{className:"text-sm text-green-700 font-semibold",children:"Registered tenants"})]})]}),(0,a.jsxs)(i.Zp,{className:"bg-gradient-to-br from-blue-50 to-blue-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-bold text-blue-800",children:"Active Tenants"}),(0,a.jsx)("div",{className:"p-2 bg-blue-500 rounded-lg",children:(0,a.jsx)(h.A,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-900",children:Z.filter(e=>"ACTIVE"===e.status).length}),(0,a.jsx)("p",{className:"text-sm text-blue-700 font-semibold",children:"Currently active"})]})]}),(0,a.jsxs)(i.Zp,{className:"bg-gradient-to-br from-purple-50 to-purple-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-bold text-purple-800",children:"Occupancy Rate"}),(0,a.jsx)("div",{className:"p-2 bg-purple-500 rounded-lg",children:(0,a.jsx)(u.A,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-900",children:"85%"}),(0,a.jsx)("p",{className:"text-sm text-purple-700 font-semibold",children:"Properties occupied"})]})]}),(0,a.jsxs)(i.Zp,{className:"bg-gradient-to-br from-orange-50 to-orange-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,a.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(i.ZB,{className:"text-sm font-bold text-orange-800",children:"New This Month"}),(0,a.jsx)("div",{className:"p-2 bg-orange-500 rounded-lg",children:(0,a.jsx)(x.A,{className:"h-4 w-4 text-white"})})]}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-orange-900",children:"3"}),(0,a.jsx)("p",{className:"text-sm text-orange-700 font-semibold",children:"New registrations"})]})]})]}),k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.jc,{onSubmit:X,initialData:T,isEditing:!!T,properties:Q,rooms:L,onPropertySelect:e=>{e&&H(e)}}),(0,a.jsx)("div",{className:"p-4 border-t",children:(0,a.jsx)(d.$,{variant:"outline",onClick:()=>{A(!1),R(null)},className:"w-full",children:"Close"})})]})}),E&&S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Login Credentials"}),(0,a.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{P(!1),F(null)},children:"âœ•"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("p",{className:"text-sm text-blue-700 font-semibold mb-2",children:["Tenant: ",S.name]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Username:"}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:S.username})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Password:"}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:S.password})]})]})]}),(0,a.jsx)("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:(0,a.jsx)("p",{className:"text-sm text-yellow-700 font-medium",children:"\uD83D\uDCA1 Share these credentials with the tenant for their account access"})})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)(d.$,{onClick:()=>{navigator.clipboard.writeText("Username: ".concat(S.username,"\nPassword: ").concat(S.password)),$({type:"success",title:"Copied to Clipboard",message:"Credentials copied to clipboard",read:!1})},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold",children:"Copy Credentials"}),(0,a.jsx)(d.$,{variant:"outline",onClick:()=>{P(!1),F(null)},className:"flex-1",children:"Close"})]})]})})}),(0,a.jsx)(o.b,{data:Z,columns:es,onRowClick:ee,actions:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{className:"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center",onClick:()=>{R(e),A(!0)},children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,a.jsxs)("button",{className:"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center",onClick:()=>ee(e),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"View Profile"]}),(0,a.jsxs)("button",{className:"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center",onClick:()=>{F(e),P(!0)},children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"View Credentials"]}),(0,a.jsxs)("button",{className:"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center",onClick:()=>{$({type:"info",title:"Call Tenant",message:"Calling ".concat(e.name," at ").concat(e.phone),read:!1}),window.open("tel:".concat(e.phone),"_self")},children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Call"]}),(0,a.jsxs)("button",{className:"w-full px-4 py-2 text-left text-red-600 hover:bg-gray-100 flex items-center",onClick:()=>Y(e.id),children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})]})})})}}},e=>{e.O(0,[8779,8405,9420,4939,1486,9290,622,1097,2432,7979,1899,4450,9744,2322,433,2652,3494,2574,2903,9173,558,1356,309,4191,2834,957,6691,1151,9473,1172,7650,3976,6292,5848,8861,2076,7358],()=>e(e.s=37999)),_N_E=e.O()}]);
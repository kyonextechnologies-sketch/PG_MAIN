(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9429],{60522:(e,s,t)=>{Promise.resolve().then(t.bind(t,63566))},63566:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>R});var l=t(95155),a=t(12115),r=t(5634),n=t(11829),i=t(86948),c=t(3998),d=t(11647),x=t(11186),o=t(52056),m=t(26983),h=t(42529),u=t(89559),j=t(86651),g=t(20508),N=t(23664),b=t(69141),p=t(71871),f=t(21873),v=t(16485),w=t(57828),y=t(64269),A=t(74044),E=t(68796);function R(){let[e,s]=(0,a.useState)(""),[t,R]=(0,a.useState)("ALL"),[L,S]=(0,a.useState)("ALL"),[C,O]=(0,a.useState)(null),[q,P]=(0,a.useState)(!1),[k,I]=(0,a.useState)({type:null,message:""}),{tickets:_,loading:T,error:V,fetchTickets:Z,updateTicket:F}=(0,A.Y)(),{addNotification:M}=(0,E.j)();a.useEffect(()=>{_.length},[_.length]);let B=_.filter(s=>{var l;let a=s.title.toLowerCase().includes(e.toLowerCase())||s.description.toLowerCase().includes(e.toLowerCase())||(null==(l=s.tenantId)?void 0:l.toLowerCase().includes(e.toLowerCase())),r="ALL"===t||s.status===t,n="ALL"===L||s.priority===L;return a&&r&&n}),D=async(e,s)=>{P(!0),I({type:null,message:""});try{if(await F(e,{status:s}))I({type:"success",message:"Request status updated to ".concat(s)}),M({type:"success",title:"Status Updated",message:"Request status updated to ".concat(s),read:!1}),setTimeout(()=>{I({type:null,message:""})},3e3);else throw Error("Failed to update ticket")}catch(e){I({type:"error",message:e instanceof Error?e.message:"Failed to update status"}),M({type:"error",title:"Update Failed",message:e instanceof Error?e.message:"Failed to update request status",read:!1})}finally{P(!1)}},G=async(e,s)=>{P(!0),I({type:null,message:""});try{if(await F(e,{assignedTo:s,status:"IN_PROGRESS"}))M({type:"success",title:"Request Assigned",message:"Request assigned to ".concat(s),read:!1});else throw Error("Failed to assign ticket")}catch(e){M({type:"error",title:"Assignment Failed",message:e instanceof Error?e.message:"Failed to assign request",read:!1})}finally{P(!1)}},W=_.filter(e=>"OPEN"===e.status).length,Y=_.filter(e=>"IN_PROGRESS"===e.status).length,U=_.filter(e=>"RESOLVED"===e.status).length;return(0,l.jsx)(n.m8,{role:"OWNER",children:(0,l.jsx)(r.O,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[k.type&&(0,l.jsx)("div",{className:"p-4 rounded-lg border ".concat("success"===k.type?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"),children:(0,l.jsxs)("div",{className:"flex items-center",children:["success"===k.type?(0,l.jsx)(h.A,{className:"h-5 w-5 mr-2"}):(0,l.jsx)(o.A,{className:"h-5 w-5 mr-2"}),k.message]})}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Maintenance Requests"}),(0,l.jsx)("p",{className:"text-gray-700 font-semibold",children:"Manage and track tenant maintenance requests"})]}),(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)(c.$,{variant:"outline",onClick:()=>window.location.reload(),children:[(0,l.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Refresh"]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)(i.Zp,{className:"bg-gradient-to-br from-red-50 to-red-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-bold text-red-800",children:"Open Requests"}),(0,l.jsx)("div",{className:"p-2 bg-red-500 rounded-lg",children:(0,l.jsx)(o.A,{className:"h-4 w-4 text-white"})})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-red-900",children:W}),(0,l.jsx)("p",{className:"text-sm text-red-700 font-semibold",children:"Require attention"})]})]}),(0,l.jsxs)(i.Zp,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-bold text-yellow-800",children:"In Progress"}),(0,l.jsx)("div",{className:"p-2 bg-yellow-500 rounded-lg",children:(0,l.jsx)(m.A,{className:"h-4 w-4 text-white"})})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-yellow-900",children:Y}),(0,l.jsx)("p",{className:"text-sm text-yellow-700 font-semibold",children:"Being worked on"})]})]}),(0,l.jsxs)(i.Zp,{className:"bg-gradient-to-br from-green-50 to-green-100 shadow-xl border-0 hover:shadow-2xl transition-all duration-300",children:[(0,l.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ZB,{className:"text-sm font-bold text-green-800",children:"Resolved"}),(0,l.jsx)("div",{className:"p-2 bg-green-500 rounded-lg",children:(0,l.jsx)(h.A,{className:"h-4 w-4 text-white"})})]}),(0,l.jsxs)(i.Wu,{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-green-900",children:U}),(0,l.jsx)("p",{className:"text-sm text-green-700 font-semibold",children:"Completed"})]})]})]}),(0,l.jsxs)(i.Zp,{className:"bg-white shadow-xl border-0",children:[(0,l.jsx)(i.aR,{children:(0,l.jsx)(i.ZB,{className:"text-lg font-bold text-gray-900",children:"Filters"})}),(0,l.jsx)(i.Wu,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Search"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(j.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,l.jsx)("input",{type:"text",placeholder:"Search requests...",value:e,onChange:e=>s(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Status"}),(0,l.jsxs)(x.l6,{value:t,onValueChange:R,children:[(0,l.jsx)(x.bq,{children:(0,l.jsx)(x.yv,{placeholder:"All Status"})}),(0,l.jsxs)(x.gC,{children:[(0,l.jsx)(x.eb,{value:"ALL",children:"All Status"}),(0,l.jsx)(x.eb,{value:"OPEN",children:"Open"}),(0,l.jsx)(x.eb,{value:"IN_PROGRESS",children:"In Progress"}),(0,l.jsx)(x.eb,{value:"RESOLVED",children:"Resolved"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Priority"}),(0,l.jsxs)(x.l6,{value:L,onValueChange:S,children:[(0,l.jsx)(x.bq,{children:(0,l.jsx)(x.yv,{placeholder:"All Priority"})}),(0,l.jsxs)(x.gC,{children:[(0,l.jsx)(x.eb,{value:"ALL",children:"All Priority"}),(0,l.jsx)(x.eb,{value:"LOW",children:"Low"}),(0,l.jsx)(x.eb,{value:"MEDIUM",children:"Medium"}),(0,l.jsx)(x.eb,{value:"HIGH",children:"High"})]})]})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)(c.$,{variant:"outline",onClick:()=>{s(""),R("ALL"),S("ALL")},className:"w-full",children:"Clear Filters"})})]})})]}),(0,l.jsxs)(i.Zp,{className:"bg-white shadow-xl border-0",children:[(0,l.jsxs)(i.aR,{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-t-lg",children:[(0,l.jsxs)(i.ZB,{className:"text-lg font-bold text-gray-900",children:["Maintenance Requests (",B.length,")"]}),(0,l.jsx)(i.BT,{className:"text-sm text-gray-600 font-semibold",children:"Manage tenant maintenance requests"})]}),(0,l.jsx)(i.Wu,{children:(0,l.jsx)("div",{className:"space-y-4",children:B.map(e=>{var s,t,a,r,n,i;return(0,l.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border border-gray-200 rounded-lg p-6 hover:shadow-md transition-all duration-300",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:(e=>{switch(e){case"OPEN":return(0,l.jsx)(o.A,{className:"h-4 w-4 text-red-600"});case"IN_PROGRESS":return(0,l.jsx)(m.A,{className:"h-4 w-4 text-yellow-600"});case"RESOLVED":return(0,l.jsx)(h.A,{className:"h-4 w-4 text-green-600"});default:return(0,l.jsx)(m.A,{className:"h-4 w-4 text-gray-600"})}})(e.status)}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)("h4",{className:"font-bold text-lg text-gray-900",children:e.title}),(0,l.jsx)(d.E,{className:(0,y.qY)(e.status),children:e.status}),(0,l.jsx)(d.E,{className:(0,y.eX)(e.priority),children:e.priority})]}),(0,l.jsx)("p",{className:"text-gray-700 mb-3",children:e.description}),(0,l.jsxs)("div",{className:"bg-white rounded-lg p-4 mb-3",children:[(0,l.jsxs)("h5",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[(0,l.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Tenant Details"]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(g.A,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,l.jsx)("span",{className:"font-medium",children:(null==(s=e.tenant)?void 0:s.name)||"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(N.A,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,l.jsx)("span",{children:(null==(t=e.tenant)?void 0:t.email)||"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(b.A,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,l.jsx)("span",{children:(null==(a=e.tenant)?void 0:a.phone)||"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(p.A,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,l.jsx)("span",{children:(null==(r=e.tenant)?void 0:r.property)||"N/A"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(f.A,{className:"h-3 w-3 mr-2 text-gray-500"}),(0,l.jsxs)("span",{children:[(null==(n=e.tenant)?void 0:n.room)||"N/A"," - ",(null==(i=e.tenant)?void 0:i.bed)||"N/A"]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(v.A,{className:"h-3 w-3 mr-1"}),"Created: ",(0,y.Yq)(e.createdAt)]}),e.assignedTo&&(0,l.jsxs)("span",{className:"flex items-center",children:[(0,l.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"Assigned to: ",e.assignedTo]}),e.resolvedAt&&(0,l.jsxs)("span",{className:"flex items-center text-green-600",children:[(0,l.jsx)(h.A,{className:"h-3 w-3 mr-1"}),"Resolved: ",(0,y.Yq)(e.resolvedAt)]})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,l.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{O(e)},children:[(0,l.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"View"]}),"OPEN"===e.status&&(0,l.jsxs)(x.l6,{onValueChange:s=>{G(e.id,s).catch(e=>{})},children:[(0,l.jsx)(x.bq,{className:"w-32",children:(0,l.jsx)(x.yv,{placeholder:"Assign to"})}),(0,l.jsxs)(x.gC,{children:[(0,l.jsx)(x.eb,{value:"Maintenance Team",children:"Maintenance Team"}),(0,l.jsx)(x.eb,{value:"Electrician",children:"Electrician"}),(0,l.jsx)(x.eb,{value:"Plumber",children:"Plumber"}),(0,l.jsx)(x.eb,{value:"AC Technician",children:"AC Technician"})]})]}),"RESOLVED"!==e.status&&(0,l.jsxs)(x.l6,{onValueChange:s=>{D(e.id,s).catch(e=>{})},children:[(0,l.jsx)(x.bq,{className:"w-32",children:(0,l.jsx)(x.yv,{placeholder:"Update Status"})}),(0,l.jsxs)(x.gC,{children:[(0,l.jsx)(x.eb,{value:"IN_PROGRESS",children:"In Progress"}),(0,l.jsx)(x.eb,{value:"RESOLVED",children:"Resolved"})]})]}),"OPEN"===e.status&&(0,l.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>(e.id,void M({type:"success",title:"Notification Acknowledged",message:"You will no longer receive reminders for this request",read:!1})),className:"w-32 bg-green-50 border-green-200 text-green-700 hover:bg-green-100",children:[(0,l.jsx)(h.A,{className:"h-3 w-3 mr-1"}),"Got it"]})]})]})},e.id)})})})]})]})})})}}},e=>{e.O(0,[8779,8405,9420,4939,1486,9290,622,1097,2432,7979,1899,4450,9744,2322,433,2652,3494,2574,2903,9173,558,1356,309,4191,2834,957,6691,1151,9473,1172,7650,3976,6292,5848,8861,2076,7358],()=>e(e.s=60522)),_N_E=e.O()}]);